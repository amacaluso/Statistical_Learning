##<a name="1_Introduzione" style="pointer-events: none; cursor: default;" ><font color="black"> 1. Introduzione </font></a>


Lo scopo di questo report è portare avanti un'analisi di classificazione a partire dai dati riguardanti alcune caratteristiche fisico-chimiche del vino portoghese Vinho Verde, mettendo a confronto vari modelli e individuando quello migliore sulla base delle performance di previsione. 

I dati a disposizione sono organizzati in due tabelle separate a seconda della tipologia di vino (rosso, 1599 unità, o bianco, 4898), tuttavia ai fini di questa analisi i due dataset sono stati uniti ed è stata aggiunta una variabile, *type*, che vale rispettivamente 0 e 1 in base alla categoria a cui ciascuna unità appartiene, per un totale di $n=6497$ unità statistiche. 
La variabile target presa in esame è *quality*, che esprime la qualità del vino e che è stata ottenuta come mediana di almeno 3 voti (da 0 a 10) espressi da esperti sommelier.

```{r, fig.width=9.5, fig.height=5, echo=FALSE}
file = "results/EXPLORATORY_ANALYSES/quality_distr.Rdata"
load( file )
quality_distr
```

<br></br>
<br></br>

Come si evince dall'istogramma riportato sopra, questa feature è una variabile politomica ordinata con modalità osservate che variano nell'intervallo $[3,9] \in \mathbb{N}$.
Già a primo sguardo emerge molto chiaramente che le modalità 5 e 6 sono le più numerose, caratterizzando da sole il 76,6% del totale delle unità statistiche. Per questo motivo, per ottenere classi bilanciate, abbiamo pensato di introdurre una nuova variabile target a partire dalla variabile *quality* definita come segue: 

$$ \begin{equation}
  \textit{binary_quality} = 
  \begin{cases}
   1    &\textit{se quality} > 5  \\ 0       &\textit{altrimenti}
   \end{cases}
\end{equation}$$


Per ogni osservazione sono state misurate le seguenti caratteristiche fisico-chimiche:

* Acidità fissa (*fixed.acidity*)
* Acidità volatile (*volatile.acidity*)
* Acido citrico (*citric.acid*)
* Zucchero residuo (*residual.sugar*)
* Cloruri (*chlorides*)
* Anidride solforosa libera (*free.sulfur.dioxide*)
* Anidride solforosa totale (*total.sulfur.dioxide*)
* Densità (*density*)
* pH (*pH*)
* Solfati (*sulphates*)
* Alcol (*alcohol*)

Di seguito sono riportate le densità di ciascuna variabile mettendo a confronto le distribuzioni in ciascuno dei due sottocampioni (curve del rispettivo colore) e nel dataset completo (curva blu):

<br></br>
```{r, fig.width=9.5, fig.height=8, echo=FALSE}
file = "results/EXPLORATORY_ANALYSES/variables_density.Rdata"
load( file )


p1 = plots[[1]]
p2 = plots[[2]]
p3 = plots[[3]]
p4 = plots[[4]]
p5 = plots[[5]]
p6 = plots[[6]]
p7 = plots[[7]]
p8 = plots[[8]]
p9 = plots[[9]]
p10 = plots[[10]]
p11 = plots[[11]]
p12 = plots[[12]]

multi_p = multiplot(p1, p2, p3, p4, p5, p6, p7, p8, p9, p10, p11, p12, cols = 4 )



```

<br></br>
<br></br>


Le variabili sono quasi tutte *bell-shaped* ad eccezione di *total.sulfur.dioxide*, *citric.acid* e *chlorides* che mostrano alcuni sintomi di multimodalità, inoltre presentano per la maggior parte range di variazioni abbastanza simili. Malgrado quest'ultima caratteristica suggerisca una pre-lavorazione dei dati di input (e.g. standardizzazione), all'atto pratico i risultati non sembrano risentirne sensibilmente, per cui per comodità nel seguito è riportata l'analisi con i dati non trasformati.


Sebbene la correlazione non implichi necessariamente un collegamento causa-effetto delle variabili considerate, può comunque essere utile in ottica esplorativa indagare sul legame di interdipendenza tra la variabile *quality* e i predittori.

Di seguito è riportata la matrice di correlazione calcolata considerando l'intero dataset:

```{r, fig.width=9.5, fig.height=4, echo=FALSE}
file = "results/EXPLORATORY_ANALYSES/corrplot.Rdata"
load( file )
corrplot
```

<br></br>
<br></br>

La variabile *quality* (nella sua forma originale) è molto poco correlata con i diversi predittori. Solo in 2 casi, infatti, si ottiene un coefficiente di correlazione lineare maggiore di 0.3 (*alcohol*, *density*); d'altro canto, invece, alcuni predittori risultano molto correlati tra di loro. In particolare i valori più alti (in valore assoluto) che è possibile osservare nella matrice di correlazione sono:

- *free.sulfur.dioxide* - *total.sulfur.dioxide* (0.72)
- *density* - *alcohol* (-0.687)
- *density* - *residual.sugar* (0.553)

Considerando la natura della variabile *quality* è opportuno valutare la correlazione tra essa e le diverse variabili esplicative considerando il coefficiente di Spearman piuttosto che il coefficiente di Pearson:

```{r, fig.width=9.5, fig.height=4, echo=FALSE}
file = "results/EXPLORATORY_ANALYSES/corr_Y.Rdata"
load( file )
corr_Y
```

<br></br>
<br></br>

Il coefficiente di correlazione di Spearman misura il grado di relazione tra due variabili per le quali non si fa altra ipotesi se non la natura ordinale, tuttavia può essere usato anche per variabili continue. Inoltre, non si limita ad individuare solamente relazioni di tipo lineare, come avviene invece per il coefficiente di correlazione di Pearson, ed è quindi preferibile.

Per maggiori informazioni sui dati è possibile consultare il sito:

https://archive.ics.uci.edu/ml/datasets/wine+quality


I risultati riportati nel seguito sono stati ottenuti sfruttando una divisione dei dati in training (60%) e test (40%) set.


<br></br>
<br></br>